<html><head><title>LtU Classic Archives</title></head><body><h1 class='title'><a href='http://lambda-the-ultimate.org/'>Lambda the Ultimate</a></h1><table><tr><td><table><tr><td>
<table bgcolor="navy" cellpadding="5" cellspacing="0" border="0" width="100%"><tr>
<td>
<img src='folder2.gif' height="14" width="17" border="0" alt="inactiveTopic"> <font color="white"><b>Paul Graham: Accumulator Generator</b></font><br>
<font color="white" size="-1">started 2/13/2003; 6:11:48 AM - last post 2/18/2003; 11:41:29 AM</font>
</td>
</tr></table>
</td></tr>
<tr><td>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Manuel Simoni</a> - Paul Graham: Accumulator Generator <a name="5779">&nbsp;</a><a href='#5779' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/13/2003; 6:11:48 AM (reads: 3849, responses: 14)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
<a name="a5779"></a><table border="0" cellspacing="10" width="400">
	<tr>
		<td colspan="2" align="left" valign="top" width="85%" bgcolor="#E6E6E6"><b><a href="http://www.paulgraham.com/accgen.html">Paul Graham: Accumulator Generator</a></b></td>
		</tr>
	<tr>
		<td align="left" valign="top">
			<font color="blue"><i>The problem: Write a function foo that takes a number n and returns a function that takes a number i, and returns n incremented by i.
</i></font><p>
<p>A comparison between about twenty languages. Paul Graham's <a href="http://www.paulgraham.com/arc.html">Arc</a> and <a href="http://wsmith.best.vwh.net/works.html">NewtonScript</a> (a selfish and schemish language-OS hybrid for the Apple Newton) seem have the most pragmatic syntaxes.</p><p>
<p><small>NewtonScript link via <a href="http://www.dekorte.com">Steve Dekorte</a>.</small></p><br>
			<font size="-2"><b>Posted to <a href='functional.html'>functional</a> by <a href='http://lambda-the-ultimate.org/'>Manuel Simoni</a> on 2/13/03; 6:17:10 AM</b><br>
			</font><br>
			<font size="-2">  </font>
			</td>
		<td valign="top" align="right" width="15%">
			
			</td>
		</tr>
	</table>
<p>
<p></p>
<p><a href='#5779'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Joshua Rothenberg</a> - Re: Paul Graham: Accumulator Generator <a name="5783">&nbsp;</a><a href='#5783' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/13/2003; 4:09:46 PM (reads: 2086, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
I can't figure out how to sumbit new versions to him, but the Python version he has is just plain silly.
A much more reasonable method is:<p>

>>> def foo(n):<p>

...     return lambda i: n+i<p>


Updated: as Manuel Simoni has pointed out, I obviously wasn't paying attention when I wrote this -_- ....
<p></p>
<p><a href='#5783'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Tim Sweeney</a> - Re: Paul Graham: Accumulator Generator <a name="5784">&nbsp;</a><a href='#5784' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/13/2003; 4:17:36 PM (reads: 2140, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
From the site:<p>

>> Note: (a) that's number, not integer, (b) that's incremented by, not plus. &lt;&lt;<p>

This is an interesting study of solutions to an ill-defined problem.<p>

1. The term "number" is left undefined.  If the problem we posed in terms of "integers" or "natural numbers", it would be clear.  Are complex numbers, numbers?  Are p-adics and reals, numbers?  If you define "number" to include all of these different mathematical objects, then the problem is ill-typed because, for example, you can't add a p-adic to a real.  The problem doesn't define what should happen in this case; should it crash?  Return 7*pi?<p>

2. You can't "increment a number". Adding 2 to 3 doesn't change the value of 3!  3 still remains 3.  Numbers, as defined by mathematics sense, are immutable.  One might correct this by indicating that your function should take a reference to an integer, and add a certain integer to the value referred to.  But is such a function actually a function?  Not in the mathematical sense.  What about the case where the reference is null, if the language supports such a concept?<p>

What the article did succeed in doing, if you read through the code examples, is highlight the non-portability (across languages) of programs depending on ill-defined concepts like "references" and "numbers".  The problem as posed can't be solved minimally (with neither error cases nor behaviour beyond what is specified) in any of the languages shown!<p>

-Tim
<p></p>
<p><a href='#5784'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Patrick Logan</a> - Re: Paul Graham: Accumulator Generator <a name="5785">&nbsp;</a><a href='#5785' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/13/2003; 4:30:07 PM (reads: 2064, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
I had the same response as Tim: while this comparison says somewhat interesting things about various languages, the description itself is a study on poor specifications.<p>

BTW somebody from the Mozart team better get a more palatable sample on that page quick. What a mess!<p>

Erlang: Yes! Maybe this will get people to realize just how lightweight their processes are.
<p></p>
<p><a href='#5785'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Manuel Simoni</a> - Re: Paul Graham: Accumulator Generator <a name="5786">&nbsp;</a><a href='#5786' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/13/2003; 5:59:11 PM (reads: 2029, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
<p><i>&gt; The term "number" is left undefined.</i></p><p>

<p>On the companion page, <a href="http://www.paulgraham.com/accgensub.html">accgensub.html</a>, "number" is somewhat defined: <i>Works for any numeric type-- i.e. can take both ints and floats and returns functions that can take both ints and floats. </i></p><p>

<p>It's probably supposed to be an abstract data type that supports the + message, and not a pure mathematical number. It is right that nothing is said about the paradigm used to describe the situation (for example message-passing paradigm.)<p>

<p><i>&gt; the Python version he has is just plain silly</i></p><p>

<p>I do not know Python, but it seems to me that <code>def foo(n): return lambda i: n+i</code> would violate point 3 on the companion page (<i>Generates functions that return the sum of every number ever passed to them, not just the most recent.</i>) because n is never incremented.</p>
<p></p>
<p><a href='#5786'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Todd Coram</a> - Re: Paul Graham: Accumulator Generator <a name="5789">&nbsp;</a><a href='#5789' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/14/2003; 6:38:40 AM (reads: 1975, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
The OO examples (C++ and Python) are something of a cheat since they rely on object instantiation as the "function returning a function". But, then again, its only a cheat if Graham was trying to make a point about unamed function and closure support in languages.<p>

A couple of Tcl solutions (<a href="http://mini.net/tcl/3520"><a href="http://mini.net/tcl/3520">http://mini.net/tcl/3520</a></a>) were turned down (for unclear reasons), so I imagine that the interpretation of the requirements are subject to Graham's tastes.
<p></p>
<p><a href='#5789'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Ruiner</a> - Re: Paul Graham: Accumulator Generator <a name="5795">&nbsp;</a><a href='#5795' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/14/2003; 4:25:46 PM (reads: 1881, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
Interesting that he specifically excludes ocaml and ml because they have no way to implictly intermingle floats and ints.  Of course, I still haven't figured out why it is that ocaml will allow you to write comparisons that work on ints or floats but not arithmetic operators.  i.e.
<pre>
# let comp x y = x &lt; y;;
val comp : 'a -> 'a -> bool = &lt;fun>
# comp 1 2;;
- : bool = true
# comp 1.2 2.2;;
- : bool = true
</pre>
It's kind of an annoying wrinkle on an otherwise nicely balanced language.
<p></p>
<p><a href='#5795'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Isaac Gouy</a> - Re: Paul Graham: Accumulator Generator <a name="5796">&nbsp;</a><a href='#5796' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/15/2003; 8:36:44 AM (reads: 1824, responses: 1)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
<i>ocaml will allow you to write comparisons that work on ints or floats but not arithmetic operators</i><br />
I'm unsure what you mean, could you say more.
<p></p>
<p><a href='#5796'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Ehud Lamm</a> - Re: Paul Graham: Accumulator Generator <a name="5797">&nbsp;</a><a href='#5797' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/15/2003; 9:39:27 AM (reads: 1874, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
Since I haven't used Ocaml I can only speculate. Aren't these the same as the equality types in ML?
<p></p>
<p><a href='#5797'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Isaac Gouy</a> - Re: Paul Graham: Accumulator Generator <a name="5799">&nbsp;</a><a href='#5799' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/15/2003; 10:54:14 AM (reads: 1796, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
I was unclear. As far as I can tell you can't directly compare int with float, and you can't directly use arith operators for int with float. 
<pre>
# comp 1 1.0;;
Characters 7-10:
  comp 1 1.0;;
         ^^^
This expression has type float but is here used with type int<p>

# 1 + 1.0 ;;
Characters 4-7:
  1 + 1.0 ;;
      ^^^
This expression has type float but is here used with type int
</pre><p>


Oh, I see, Ruiner was pointing out that int and float use the same relational operators &lt; > = but use different arithmetic operators: + * for int but +. *. for float
<p></p>
<p><a href='#5799'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Isaac Gouy</a> - Re: Paul Graham: Accumulator Generator <a name="5801">&nbsp;</a><a href='#5801' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/15/2003; 1:01:01 PM (reads: 1765, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
Tim wrote <i>This is an interesting study of solutions to an ill-defined problem</i> <br />
With just int and float, I wonder if the solutions listed do the same implicit numeric conversions, and give the same result?
<p></p>
<p><a href='#5801'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Dan Shappir</a> - Re: Paul Graham: Accumulator Generator <a name="5810">&nbsp;</a><a href='#5810' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/17/2003; 1:25:20 AM (reads: 1682, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
You should check out Sjoerd's <a href="http://w3future.com/weblog/2003/02/16.xml#a166">Accumulator Generator implementation</a> using <a href="http://w3future.com/html/loell/">Loell</a>, it's the shortest one yet. This is not so surprising considering that the Accumulator Generator design pattern as presented by Paul Graham is best supported by closures, and Loell is all about closures.
<p></p>
<p><a href='#5810'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Ruiner</a> - Re: Paul Graham: Accumulator Generator <a name="5818">&nbsp;</a><a href='#5818' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/17/2003; 1:03:33 PM (reads: 1668, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
<i style="background: #dddddd"> Oh, I see, Ruiner was pointing out that int and float use the same relational operators &lt; &gt; = but use different arithmetic operators: + * for int but +. *. for float </i>
<br>
Indeed. The reason I was pointing it out is that if ocaml's (+)  supported the same sort of overloading as (&lt;), then Graham's generator could be written:
<pre>
let foo n = let x = ref n in function i -> x := !x + i; !x;;
</pre><p>

It would be convenient if operators and functions could be overloaded in ocaml. But at the same time I still have not the feeling that it makes that much difference in practice.  However, I understand someone <a href="http://pauillac.inria.fr/~furuse/generics/">has implemented this</a>. But I can't tell if it will ever be incorporated into the language.
<p></p>
<p><a href='#5818'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Isaac Gouy</a> - Re: Paul Graham: Accumulator Generator <a name="5835">&nbsp;</a><a href='#5835' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/18/2003; 10:50:02 AM (reads: 1568, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
<i>Graham's generator could be written</i> <br />
Let me take this opportunity to be wrong ;-)<br />
Let's say ocaml's + did have the same sort of overloading as ocaml's &lt;<p>

Why would that help with accumlator generator?
As far as I can see, int &lt; int is valid, float &lt; float is valid, but int &lt; float is invalid.
So even if + supported the same sort of overloading as &lt;, wouldn't int + float be invalid?
<p></p>
<p><a href='#5835'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" width="100%" style="border: 1px solid navy; border-top: none;">
<tr bgcolor="skyblue">
<td>
<table width="100%" cellpadding="3" cellspacing="0"><tr>
<td>
<a href='http://lambda-the-ultimate.org/'>Ruiner</a> - Re: Paul Graham: Accumulator Generator <a name="5836">&nbsp;</a><a href='#5836' ><img src='leftArrow.gif' height="9" width="11" border="0" alt="blueArrow"></a><br>
<font size="-1">2/18/2003; 11:41:29 AM (reads: 1567, responses: 0)</font>
</td>
</tr></table>
</td>
</tr>
<tr><td>
<table width="100%" cellpadding="3" cellspacing="0" style="border-top: 1px solid navy;"><tr><td>
It depends on how '+' was defined but if it were defined as 
<pre>
   generic plus = case
   | int -> int -> int => (+)
   | float -> float -> float => (+.)
   | int -> float -> float => fun x y -> float x +. y
   | float -> int -> float => fun x y -> x +. float y
   ...
</pre>
then it would work just fine (stolen from <a href=http://pauillac.inria.fr/~furuse/thesis/chapter01.ps.gz"><a href="http://pauillac.inria.fr/~furuse/thesis/chapter01.ps.gz">http://pauillac.inria.fr/~furuse/thesis/chapter01.ps.gz</a></a>)
<p></p>
<p><a href='#5836'><img src='skull.gif' height="18" width="22" border="0"></a></p>
</td></tr></table>
</td></tr>
</table><p>

</td></tr>
</table><p>


<p>
</td>
</tr>
</table></body></html>
